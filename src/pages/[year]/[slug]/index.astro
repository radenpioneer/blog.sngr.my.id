---
import { getCollection } from 'astro:content'
import PageLayout from '~/layouts/page.astro'

export const getStaticPaths = async () => {
  const posts = await getCollection('posts')
  return posts.map((post) => {
    return {
      params: {
        year: new Date(post.data.date).getFullYear(),
        slug: post.slug,
      },
      props: { post },
    }
  })
}

const { post: postData } = Astro.props
const {
  data: { title, description, date, hidden },
} = postData
const { Content } = await postData.render()
---

<PageLayout title={title} description={description} date={date} hidden={hidden}>
  <Content />
</PageLayout>
